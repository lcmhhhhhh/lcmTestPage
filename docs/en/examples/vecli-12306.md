# Preparations

## Download vecli

```Bash
npm i @volc-iaas-test01/vecli@latest -g
```

## Add Volcano Vefaas MCP

```Bash
vi ~/.ve/settings.json

# Add new Volcano Vefaas mcp server
"mcpServers": {
    "mcp_server_vefaas_function": {
      "httpUrl": "https://vefaas.mcp.volcbiz.com/mcp?token=eyJhbGciOiJSUzI1NiIsImtpZCI6IjczZDA1MzM1NGJjNDExZWY5NGU2ZThlYmQzMmVlNmUyIn0.eyJhdWQiOlsibWNwLXZlZmFhcy02NjE3NTFmYjhiIl0sImV4cCI6MTc1NzMyMzUxNiwiaWF0IjoxNzU3MTUwNzE2LCJpc3MiOiJodHRwczovL3NpZ25pbi52b2xjZW5naW5lLmNvbSIsImp0aSI6IjY2MTc1MjE0OGIwMzExZjBhOTczMzQzNmFjMTIwMDU3IiwibXNnIjoiSDRzSUFBQUFBQUFDLytKeTVXSUpkdlQxRVRJc0tjcXp5a3pNdGJJeU1qQXdNREEwTWpReHR5b3RUaTNTenluTlQ4NG96Y3ROelhSSXFpeEpUVW5NUzA3VlM4N1BsVGo3Ky8xUk5vVnpJRkxJbElzbHREaTFTT0RoOGl0aVVod0Ivczd4bm9tSndVcGdzNzBrY0JrQkNBQUEvLzhOVnBFVGZnQUFBQT09IiwibmFtZSI6Imx1b2NodW5tZWlAYnl0ZWRhbmNlLmNvbSIsInN1YiI6IjIwMDAwMTIxNDciLCJ0b3BpYyI6InNpZ25pbl9jcmVkZW50aWFsIiwidHJuIjoidHJuOmlhbTo6MjAwMDAxMjE0Nzp1c2VyL2x1b2NodW5tZWlAYnl0ZWRhbmNlLmNvbSIsInZlcnNpb24iOiJ2MSIsInppcCI6Imd6aXAifQ.Kb3HhmBvt8Euo0JV5y5293iPv7rTrdAh1XaW4VCFFV5zxJAudprIMZAH1_PsjJaED20BAiMB_eci97PIET-heGgwS7l99ad1mgr7GefMsYJRLPtvJBLJmfla2jyhmd9z_M7jSQcT2yXBLQkGLdOHMAfO794M4YCb8dIlq5psFjvoE8G372QpUTI5kP8MQsBjjsmyaqQo0L_KR_o0FxQRu2r8IAUT-VqWdwzrLHnX-VyuqAUVxT0XDHEfI18ElpDVyUXHpMxOSagbRcd6hIYeLQpVZdnJRPawFzT6LcQPf-dxNev6Y20ZLadezZ9koWWyuw0645D_bIhSwy24CqGsug"
    }
  }
```

# Local Build Requirements

## Create Requirement md Document

Create a working directory

```Bash
mkdir train_mcp
cd train_mcp
vi VE.md
```

Build the VE.md document

~~~Markdown
# MCP Tool Configuration for 12306 Ticket Query API (Based on Juhe Data API)

## Core Task
Based on Juhe Data's 12306 ticket query API, encapsulate it as an MCP tool and directly call the mcp tool mcp_server_vefaas_function to deploy the product to the cloud platform with the name `train_ticket_query`. The produced MCP must be correctly recognizable and callable.

## 12306 Ticket Query API Basic Information
- API Endpoint: `https://apis.juhe.cn/fapigw/train/query`
- Request Method: `GET`
- API Key: `a7c7175096aa71c02b919f43ee8222b3` (built-in, no user input required)
- Documentation Reference: [Juhe Data 12306 Ticket Query API](https://apis.juhe.cn/fapigw/train/query)

## 12306 Ticket Query MCP Tool Definition
### Tool Name
`train_ticket_query`

### Function Description
Query train ticket information for a specified date, departure station, and arrival station, returning train number, time, seat type, and ticket availability status.

### Parameter Specification
```json
{
  "name": "train_ticket_query",
  "description": "Query train ticket information for a specified date, departure station, and arrival station, returning train number, time, seat type, and ticket availability status.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "from": {
        "type": "string",
        "description": "Departure city (e.g., Beijing, use city name instead of station name)"
      },
      "to": {
        "type": "string",
        "description": "Arrival city (e.g., Shanghai)"
      },
      "date": {
        "type": "string",
        "format": "YYYY-MM-DD",
        "description": "Departure date (e.g., 2024-10-01)"
      }
    },
    "required": ["from", "to", "date"]
  }
}
```

### Result Validation
1. After deployment, check if it is correctly started
2. Ensure the mcp tool can be correctly recognized and called
3. Build a summary describing how the mcp tool should be properly added and used
~~~

# Start Execution

```Bash
# Start vecli
vecli

# Select model (kimi-k2)
/model

# Enter command
Please help me implement the requirements in the VE.md file
```

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YWZhM2RjODJjZTc2OThlOWU4NWI5ZmM2NzVlMWVhMWJfZng1TXlRV05JeWpiR004aXZxRlZsbDBWYWplUGhQdk5fVG9rZW46QTBuR2JXVWJHb3hMdE54dWduY2NheEFWblRlXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

Select Allow Always

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=OWQyNjcwOTM0MGQxNDAzYjgwODhmNDhlMjk4MzkxM2NfbGo5anV4UFloYUNCUFBqNldFZjFDb1Z3MUxkMUJwNklfVG9rZW46RUlBb2JHVVNIb2lTb3V4aVFRd2NqSklObnJjXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

Select Always Trust All Tools for mcp

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=MTlkN2VhNzUxOGEwZjMzZmJkNDI3ZDVkOGEwMTU0YjlfeWFNUHNLOGtkNU92SElKVVUxelFLbmgyczE2U2dXTUxfVG9rZW46QTV1OGJYTnd0b1ZyQ1J4d0x5SWNhTzN5bjZjXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

All necessary files are generated locally

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YTJkMWEzOTEyODdjZDNjOWM0YThmZTU0Mzg1MzllNDJfN0dvY0dQbmRrb1FpOVBQWW5ncThBNzJYRUx2MjlRSzBfVG9rZW46RklIWmIwZnBrbzBVVVp4THhtc2NaNmxDbnlHXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

Generate cloud function deployment for packaging

Test local run, select Fully Allow (yes, allow always)

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=ODNhMmM0ODYzZWZiNjk4MTUyMTgxMWQ5ZjcyOWJkMGZfNlJwSXExNDFxMThLcFdaa2pSdk5pbjV4aEt2Wk9pUDRfVG9rZW46TkFhNWJJUElGb2llQTR4MWRFYmNLbVdLbllmXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

Packaging script creates deployment package

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YWE3OWNlMDA1NGIyZmM5NWQxMDA2NjM5ZTA4M2RkOGJfS1dzR05JU1N6NFJ1SFppeFluZlF1QndiTlR2Zk5TNHpfVG9rZW46SHQ2c2J3SldDbzFGR2h4OEEyd2M1Q25ybjBlXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

# Generate mcp Cloud Service

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=MTk2MjA2ZDNkZjIyODc2MWY3MWVkZWMwMzEwMmMzYThfUlRYR3NJUG16Q2ZDb0xGT2ZFQXVHdFBNZEhZUEhNYndfVG9rZW46S2ZGSWIyVzZCbzI3TWZ4dk9KeGNJdGhGbm5mXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)