# Solve 12306 Issues with Vecli

## Preparations
### Download vecli

```Bash
npm i @volc-iaas-test01/vecli@latest -g
```

### Add Volcano Vefaas MCP

```Bash
vi ~/.ve/settings.json

# Add new Volcano Vefaas mcp server
"mcpServers": {
    "mcp_server_vefaas_function": {
      "httpUrl": "https://vefaas.mcp.volcbiz.com/mcp?xxx
    }
  }
```

## Local Build Requirements

### Create Requirement md Document

Create a working directory

```Bash
mkdir train_mcp
cd train_mcp
vi VE.md
```

Build the VE.md document

~~~Markdown
## MCP Tool Configuration for 12306 Ticket Query API (Based on Juhe Data API)

### Core Task
Based on Juhe Data's 12306 ticket query API, encapsulate it as an MCP tool and directly call the mcp tool mcp_server_vefaas_function to deploy the product to the cloud platform with the name `train_ticket_query`. The produced MCP must be correctly recognizable and callable.

### 12306 Ticket Query API Basic Information
- API Endpoint: `https://apis.juhe.cn/fapigw/train/query`
- Request Method: `GET`
- API Key: `a7c7175096aa71c02b919f43ee8222b3` (built-in, no user input required)
- Documentation Reference: [Juhe Data 12306 Ticket Query API](https://apis.juhe.cn/fapigw/train/query)

### 12306 Ticket Query MCP Tool Definition
#### Tool Name
`train_ticket_query`

#### Function Description
Query train ticket information for a specified date, departure station, and arrival station, returning train number, time, seat type, and ticket availability status.

#### Parameter Specification
```json
{
  "name": "train_ticket_query",
  "description": "Query train ticket information for a specified date, departure station, and arrival station, returning train number, time, seat type, and ticket availability status.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "from": {
        "type": "string",
        "description": "Departure city (e.g., Beijing, use city name instead of station name)"
      },
      "to": {
        "type": "string",
        "description": "Arrival city (e.g., Shanghai)"
      },
      "date": {
        "type": "string",
        "format": "YYYY-MM-DD",
        "description": "Departure date (e.g., 2024-10-01)"
      }
    },
    "required": ["from", "to", "date"]
  }
}
```

#### Result Validation
1. After deployment, check if it is correctly started
2. Ensure the mcp tool can be correctly recognized and called
3. Build a summary describing how the mcp tool should be properly added and used
~~~

## Start Execution

```Bash
# Start vecli
vecli

# Select model (kimi-k2)
/model

# Enter command
Please help me implement the requirements in the VE.md file
```

![img](/demo1.png)

Select Allow Always

![img](/demo2.png)

Select Always Trust All Tools for mcp

![img](/demo3.png)

All necessary files are generated locally

![img](/demo4.png)

Generate cloud function deployment for packaging

Test local run, select Fully Allow (yes, allow always)

![img](/demo5.png)

Packaging script creates deployment package

![img](/demo6.png)

## Generate mcp Cloud Service

![img](/demo7.png)
