1. # 前置准备

1. ## 下载vecli

```Bash
npm i @volc-iaas-test01/vecli@latest -g
```

1. ## 添加火山Vefaas MCP

```Bash
vi ~/.ve/settings.json

#新增火山Vefaas mcp server
"mcpServers": {
    "mcp_server_vefaas_function": {
      "httpUrl": "https://vefaas.mcp.volcbiz.com/mcp?token=eyJhbGciOiJSUzI1NiIsImtpZCI6IjczZDA1MzM1NGJjNDExZWY5NGU2ZThlYmQzMmVlNmUyIn0.eyJhdWQiOlsibWNwLXZlZmFhcy02NjE3NTFmYjhiIl0sImV4cCI6MTc1NzMyMzUxNiwiaWF0IjoxNzU3MTUwNzE2LCJpc3MiOiJodHRwczovL3NpZ25pbi52b2xjZW5naW5lLmNvbSIsImp0aSI6IjY2MTc1MjE0OGIwMzExZjBhOTczMzQzNmFjMTIwMDU3IiwibXNnIjoiSDRzSUFBQUFBQUFDLytKeTVXSUpkdlQxRVRJc0tjcXp5a3pNdGJJeU1qQXdNREEwTWpReHR5b3RUaTNTenluTlQ4NG96Y3ROelhSSXFpeEpUVW5NUzA3VlM4N1BsVGo3Ky8xUk5vVnpJRkxJbElzbHREaTFTT0RoOGl0aVVod0Ivczd4bm9tSndVcGdzNzBrY0JrQkNBQUEvLzhOVnBFVGZnQUFBQT09IiwibmFtZSI6Imx1b2NodW5tZWlAYnl0ZWRhbmNlLmNvbSIsInN1YiI6IjIwMDAwMTIxNDciLCJ0b3BpYyI6InNpZ25pbl9jcmVkZW50aWFsIiwidHJuIjoidHJuOmlhbTo6MjAwMDAxMjE0Nzp1c2VyL2x1b2NodW5tZWlAYnl0ZWRhbmNlLmNvbSIsInZlcnNpb24iOiJ2MSIsInppcCI6Imd6aXAifQ.Kb3HhmBvt8Euo0JV5y5293iPv7rTrdAh1XaW4VCFFV5zxJAudprIMZAH1_PsjJaED20BAiMB_eci97PIET-heGgwS7l99ad1mgr7GefMsYJRLPtvJBLJmfla2jyhmd9z_M7jSQcT2yXBLQkGLdOHMAfO794M4YCb8dIlq5psFjvoE8G372QpUTI5kP8MQsBjjsmyaqQo0L_KR_o0FxQRu2r8IAUT-VqWdwzrLHnX-VyuqAUVxT0XDHEfI18ElpDVyUXHpMxOSagbRcd6hIYeLQpVZdnJRPawFzT6LcQPf-dxNev6Y20ZLadezZ9koWWyuw0645D_bIhSwy24CqGsug"
    }
  }
```

1. # 本地构建需求

1. ## 创建需求md文档

创建工作目录

```Bash
mkdir train_mcp
cd train_mcp
vi VE.md
```

构建VE.md文档

~~~Markdown
# 12306查票API的MCP工具配置（基于聚合数据API）

## 核心任务
基于聚合数据的12306查票API，将其封装为一个MCP工具，直接调用mcp工具mcp_server_vefaas_function将产物部署部署到云平台，名称为`train_ticket_query`。产出的MCP要确保可以被正确的识别和调用。

## 12306查票API基础信息
- 接口地址：`https://apis.juhe.cn/fapigw/train/query`
- 请求方式：`GET`
- API密钥：`a7c7175096aa71c02b919f43ee8222b3`（已内置，无需用户输入）
- 文档参考：[聚合数据12306查票接口](https://apis.juhe.cn/fapigw/train/query)

## 12306查票MCP工具定义
### 工具名称
`train_ticket_query`

### 功能描述
查询指定日期、出发站和到达站的火车票信息，返回车次、时间、座位类型及余票状态。

### 参数规范
```json
{
  "name": "train_ticket_query",
  "description": "查询指定日期、出发站和到达站的火车票信息，返回车次、时间、座位类型及余票状态。",
  "inputSchema": {
    "type": "object",
    "properties": {
      "from": {
        "type": "string",
        "description": "出发站城市（如：北京，需使用城市名而非车站名）"
      },
      "to": {
        "type": "string",
        "description": "到达站城市（如：上海）"
      },
      "date": {
        "type": "string",
        "format": "YYYY-MM-DD",
        "description": "出发日期（如：2024-10-01）"
      }
    },
    "required": ["from", "to", "date"]
  }
}
```

### 结果校验
1. 部署完成后要检查是否正确被启动
2. 确保mcp工具可以被正确的识别和调用
3. 构建一个总结，描述mcp工具应该如何被正确添加和使用
~
~~~

# 开始执行

```Bash
# 启动vecli
vecli

# 选择模型 （kimi-k2）
/model

# 输入指令
请帮我实现 VE.md 文件的需求
```

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YWZhM2RjODJjZTc2OThlOWU4NWI5ZmM2NzVlMWVhMWJfZng1TXlRV05JeWpiR004aXZxRlZsbDBWYWplUGhQdk5fVG9rZW46QTBuR2JXVWJHb3hMdE54dWduY2NheEFWblRlXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

选择始终允许（allow always）

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=OWQyNjcwOTM0MGQxNDAzYjgwODhmNDhlMjk4MzkxM2NfbGo5anV4UFloYUNCUFBqNldFZjFDb1Z3MUxkMUJwNklfVG9rZW46RUlBb2JHVVNIb2lTb3V4aVFRd2NqSklObnJjXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

选择始终信任mcp的所有工具

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=MTlkN2VhNzUxOGEwZjMzZmJkNDI3ZDVkOGEwMTU0YjlfeWFNUHNLOGtkNU92SElKVVUxelFLbmgyczE2U2dXTUxfVG9rZW46QTV1OGJYTnd0b1ZyQ1J4d0x5SWNhTzN5bjZjXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

本地生成了所有必要文件

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YTJkMWEzOTEyODdjZDNjOWM0YThmZTU0Mzg1MzllNDJfN0dvY0dQbmRrb1FpOVBQWW5ncThBNzJYRUx2MjlRSzBfVG9rZW46RklIWmIwZnBrbzBVVVp4THhtc2NaNmxDbnlHXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

生成用于打包的云函数部署

测试本地运行，选择完全允许（yes， allow always）

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=ODNhMmM0ODYzZWZiNjk4MTUyMTgxMWQ5ZjcyOWJkMGZfNlJwSXExNDFxMThLcFdaa2pSdk5pbjV4aEt2Wk9pUDRfVG9rZW46TkFhNWJJUElGb2llQTR4MWRFYmNLbVdLbllmXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

打包脚本创建部署包

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=YWE3OWNlMDA1NGIyZmM5NWQxMDA2NjM5ZTA4M2RkOGJfS1dzR05JU1N6NFJ1SFppeFluZlF1QndiTlR2Zk5TNHpfVG9rZW46SHQ2c2J3SldDbzFGR2h4OEEyd2M1Q25ybjBlXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)

# 生成mcp 云服务

![img](https://bytedance.larkoffice.com/space/api/box/stream/download/asynccode/?code=MTk2MjA2ZDNkZjIyODc2MWY3MWVkZWMwMzEwMmMzYThfUlRYR3NJUG16Q2ZDb0xGT2ZFQXVHdFBNZEhZUEhNYndfVG9rZW46S2ZGSWIyVzZCbzI3TWZ4dk9KeGNJdGhGbm5mXzE3NTcyNTAyNzI6MTc1NzI1Mzg3Ml9WNA)