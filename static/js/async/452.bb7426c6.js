"use strict";(self.webpackChunklcm_test_page=self.webpackChunklcm_test_page||[]).push([["452"],{100:function(e,n,s){s.r(n),s.d(n,{default:()=>c});var r=s(5893),i=s(65);function t(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",ul:"ul",li:"li",strong:"strong",code:"code",h3:"h3",ol:"ol",h4:"h4",pre:"pre"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"mcp-servers-with-the-vecli",children:["MCP servers with the VeCLI",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mcp-servers-with-the-vecli",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"This document provides a guide to configuring and using Model Context Protocol (MCP) servers with the VeCLI."}),"\n",(0,r.jsxs)(n.h2,{id:"what-is-an-mcp-server",children:["What is an MCP server?",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#what-is-an-mcp-server",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"An MCP server is an application that exposes tools and resources to the VeCLI through the Model Context Protocol, allowing it to interact with external systems and data sources. MCP servers act as a bridge between the Gemini model and your local environment or other services like APIs."}),"\n",(0,r.jsx)(n.p,{children:"An MCP server enables the VeCLI to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Discover tools:"})," List available tools, their descriptions, and parameters through standardized schema definitions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execute tools:"})," Call specific tools with defined arguments and receive structured responses."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access resources:"})," Read data from specific resources (though the VeCLI primarily focuses on tool execution)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"With an MCP server, you can extend the VeCLI's capabilities to perform actions beyond its built-in features, such as interacting with databases, APIs, custom scripts, or specialized workflows."}),"\n",(0,r.jsxs)(n.h2,{id:"core-integration-architecture",children:["Core Integration Architecture",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#core-integration-architecture",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The VeCLI integrates with MCP servers through a sophisticated discovery and execution system built into the core package (",(0,r.jsx)(n.code,{children:"packages/core/src/tools/"}),"):"]}),"\n",(0,r.jsxs)(n.h3,{id:"discovery-layer-mcp-clientts",children:["Discovery Layer (",(0,r.jsx)(n.code,{children:"mcp-client.ts"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#discovery-layer-mcp-clientts",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The discovery process is orchestrated by ",(0,r.jsx)(n.code,{children:"discoverMcpTools()"}),", which:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Iterates through configured servers"})," from your ",(0,r.jsx)(n.code,{children:"settings.json"})," ",(0,r.jsx)(n.code,{children:"mcpServers"})," configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Establishes connections"})," using appropriate transport mechanisms (Stdio, SSE, or Streamable HTTP)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fetches tool definitions"})," from each server using the MCP protocol"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sanitizes and validates"})," tool schemas for compatibility with the Gemini API"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Registers tools"})," in the global tool registry with conflict resolution"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"execution-layer-mcp-toolts",children:["Execution Layer (",(0,r.jsx)(n.code,{children:"mcp-tool.ts"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#execution-layer-mcp-toolts",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Each discovered MCP tool is wrapped in a ",(0,r.jsx)(n.code,{children:"DiscoveredMCPTool"})," instance that:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Handles confirmation logic"})," based on server trust settings and user preferences"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Manages tool execution"})," by calling the MCP server with proper parameters"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Processes responses"})," for both the LLM context and user display"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Maintains connection state"})," and handles timeouts"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"transport-mechanisms",children:["Transport Mechanisms",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#transport-mechanisms",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"The VeCLI supports three MCP transport types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stdio Transport:"})," Spawns a subprocess and communicates via stdin/stdout"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SSE Transport:"})," Connects to Server-Sent Events endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Streamable HTTP Transport:"})," Uses HTTP streaming for communication"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"how-to-set-up-your-mcp-server",children:["How to set up your MCP server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#how-to-set-up-your-mcp-server",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The VeCLI uses the ",(0,r.jsx)(n.code,{children:"mcpServers"})," configuration in your ",(0,r.jsx)(n.code,{children:"settings.json"})," file to locate and connect to MCP servers. This configuration supports multiple servers with different transport mechanisms."]}),"\n",(0,r.jsxs)(n.h3,{id:"configure-the-mcp-server-in-settingsjson",children:["Configure the MCP server in settings.json",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configure-the-mcp-server-in-settingsjson",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["You can configure MCP servers in your ",(0,r.jsx)(n.code,{children:"settings.json"})," file in two main ways: through the top-level ",(0,r.jsx)(n.code,{children:"mcpServers"})," object for specific server definitions, and through the ",(0,r.jsx)(n.code,{children:"mcp"})," object for global settings that control server discovery and execution."]}),"\n",(0,r.jsxs)(n.h4,{id:"global-mcp-settings-mcp",children:["Global MCP Settings (",(0,r.jsx)(n.code,{children:"mcp"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#global-mcp-settings-mcp",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"mcp"})," object in your ",(0,r.jsx)(n.code,{children:"settings.json"})," allows you to define global rules for all MCP servers."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"mcp.serverCommand"})})," (string): A global command to start an MCP server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"mcp.allowed"})})," (array of strings): A list of MCP server names to allow. If this is set, only servers from this list (matching the keys in the ",(0,r.jsx)(n.code,{children:"mcpServers"})," object) will be connected to."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"mcp.excluded"})})," (array of strings): A list of MCP server names to exclude. Servers in this list will not be connected to."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcp": {\n    "allowed": ["my-trusted-server"],\n    "excluded": ["experimental-server"]\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"server-specific-configuration-mcpservers",children:["Server-Specific Configuration (",(0,r.jsx)(n.code,{children:"mcpServers"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#server-specific-configuration-mcpservers",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"mcpServers"})," object is where you define each individual MCP server you want the CLI to connect to."]}),"\n",(0,r.jsxs)(n.h3,{id:"configuration-structure",children:["Configuration Structure",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-structure",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Add an ",(0,r.jsx)(n.code,{children:"mcpServers"})," object to your ",(0,r.jsx)(n.code,{children:"settings.json"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{ ...file contains other config objects\n  "mcpServers": {\n    "serverName": {\n      "command": "path/to/server",\n      "args": ["--arg1", "value1"],\n      "env": {\n        "API_KEY": "$MY_API_TOKEN"\n      },\n      "cwd": "./server-directory",\n      "timeout": 30000,\n      "trust": false\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"configuration-properties",children:["Configuration Properties",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#configuration-properties",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Each server configuration supports the following properties:"}),"\n",(0,r.jsxs)(n.h4,{id:"required-one-of-the-following",children:["Required (one of the following)",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#required-one-of-the-following",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"command"})})," (string): Path to the executable for Stdio transport"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"url"})})," (string): SSE endpoint URL (e.g., ",(0,r.jsx)(n.code,{children:'"http://localhost:8080/sse"'}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"httpUrl"})})," (string): HTTP streaming endpoint URL"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"optional",children:["Optional",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#optional",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"args"})})," (string[]): Command-line arguments for Stdio transport"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"headers"})})," (object): Custom HTTP headers when using ",(0,r.jsx)(n.code,{children:"url"})," or ",(0,r.jsx)(n.code,{children:"httpUrl"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"env"})})," (object): Environment variables for the server process. Values can reference environment variables using ",(0,r.jsx)(n.code,{children:"$VAR_NAME"})," or ",(0,r.jsx)(n.code,{children:"${VAR_NAME}"})," syntax"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"cwd"})})," (string): Working directory for Stdio transport"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"timeout"})})," (number): Request timeout in milliseconds (default: 600,000ms = 10 minutes)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"trust"})})," (boolean): When ",(0,r.jsx)(n.code,{children:"true"}),", bypasses all tool call confirmations for this server (default: ",(0,r.jsx)(n.code,{children:"false"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"includeTools"})})," (string[]): List of tool names to include from this MCP server. When specified, only the tools listed here will be available from this server (allowlist behavior). If not specified, all tools from the server are enabled by default."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"excludeTools"})})," (string[]): List of tool names to exclude from this MCP server. Tools listed here will not be available to the model, even if they are exposed by the server. ",(0,r.jsx)(n.strong,{children:"Note:"})," ",(0,r.jsx)(n.code,{children:"excludeTools"})," takes precedence over ",(0,r.jsx)(n.code,{children:"includeTools"})," - if a tool is in both lists, it will be excluded."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"oauth-support-for-remote-mcp-servers",children:["OAuth Support for Remote MCP Servers",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#oauth-support-for-remote-mcp-servers",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"The VeCLI supports OAuth 2.0 authentication for remote MCP servers using SSE or HTTP transports. This enables secure access to MCP servers that require authentication."}),"\n",(0,r.jsxs)(n.h4,{id:"automatic-oauth-discovery",children:["Automatic OAuth Discovery",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#automatic-oauth-discovery",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"For servers that support OAuth discovery, you can omit the OAuth configuration and let the CLI discover it automatically:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "discoveredServer": {\n      "url": "https://api.example.com/sse"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"The CLI will automatically:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Detect when a server requires OAuth authentication (401 responses)"}),"\n",(0,r.jsx)(n.li,{children:"Discover OAuth endpoints from server metadata"}),"\n",(0,r.jsx)(n.li,{children:"Perform dynamic client registration if supported"}),"\n",(0,r.jsx)(n.li,{children:"Handle the OAuth flow and token management"}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"authentication-flow",children:["Authentication Flow",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#authentication-flow",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"When connecting to an OAuth-enabled server:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Initial connection attempt"})," fails with 401 Unauthorized"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"OAuth discovery"})," finds authorization and token endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Browser opens"})," for user authentication (requires local browser access)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authorization code"})," is exchanged for access tokens"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tokens are stored"})," securely for future use"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection retry"})," succeeds with valid tokens"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"browser-redirect-requirements",children:["Browser Redirect Requirements",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#browser-redirect-requirements",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important:"})," OAuth authentication requires that your local machine can:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Open a web browser for authentication"}),"\n",(0,r.jsxs)(n.li,{children:["Receive redirects on ",(0,r.jsx)(n.code,{children:"http://localhost:7777/oauth/callback"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This feature will not work in:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Headless environments without browser access"}),"\n",(0,r.jsx)(n.li,{children:"Remote SSH sessions without X11 forwarding"}),"\n",(0,r.jsx)(n.li,{children:"Containerized environments without browser support"}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"managing-oauth-authentication",children:["Managing OAuth Authentication",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#managing-oauth-authentication",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"/mcp auth"})," command to manage OAuth authentication:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List servers requiring authentication\n/mcp auth\n\n# Authenticate with a specific server\n/mcp auth serverName\n\n# Re-authenticate if tokens expire\n/mcp auth serverName\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"oauth-configuration-properties",children:["OAuth Configuration Properties",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#oauth-configuration-properties",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"enabled"})})," (boolean): Enable OAuth for this server"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"clientId"})})," (string): OAuth client identifier (optional with dynamic registration)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"clientSecret"})})," (string): OAuth client secret (optional for public clients)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"authorizationUrl"})})," (string): OAuth authorization endpoint (auto-discovered if omitted)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"tokenUrl"})})," (string): OAuth token endpoint (auto-discovered if omitted)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"scopes"})})," (string[]): Required OAuth scopes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"redirectUri"})})," (string): Custom redirect URI (defaults to ",(0,r.jsx)(n.code,{children:"http://localhost:7777/oauth/callback"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"tokenParamName"})})," (string): Query parameter name for tokens in SSE URLs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"audiences"})})," (string[]): Audiences the token is valid for"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"token-management",children:["Token Management",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#token-management",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"OAuth tokens are automatically:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Stored securely"})," in ",(0,r.jsx)(n.code,{children:"~/.ve/mcp-oauth-tokens.json"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Refreshed"})," when expired (if refresh tokens are available)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validated"})," before each connection attempt"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleaned up"})," when invalid or expired"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"authentication-provider-type",children:["Authentication Provider Type",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#authentication-provider-type",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["You can specify the authentication provider type using the ",(0,r.jsx)(n.code,{children:"authProviderType"})," property:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"authProviderType"})})," (string): Specifies the authentication provider. Can be one of the following:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"dynamic_discovery"})})," (default): The CLI will automatically discover the OAuth configuration from the server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"google_credentials"})}),": The CLI will use the Google Application Default Credentials (ADC) to authenticate with the server. When using this provider, you must specify the required scopes."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "googleCloudServer": {\n      "httpUrl": "https://my-gcp-service.run.app/mcp",\n      "authProviderType": "google_credentials",\n      "oauth": {\n        "scopes": ["https://www.googleapis.com/auth/userinfo.email"]\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"example-configurations",children:["Example Configurations",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#example-configurations",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"python-mcp-server-stdio",children:["Python MCP Server (Stdio)",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#python-mcp-server-stdio",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "pythonTools": {\n      "command": "python",\n      "args": ["-m", "my_mcp_server", "--port", "8080"],\n      "cwd": "./mcp-servers/python",\n      "env": {\n        "DATABASE_URL": "$DB_CONNECTION_STRING",\n        "API_KEY": "${EXTERNAL_API_KEY}"\n      },\n      "timeout": 15000\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"nodejs-mcp-server-stdio",children:["Node.js MCP Server (Stdio)",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#nodejs-mcp-server-stdio",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "nodeServer": {\n      "command": "node",\n      "args": ["dist/server.js", "--verbose"],\n      "cwd": "./mcp-servers/node",\n      "trust": true\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"docker-based-mcp-server",children:["Docker-based MCP Server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#docker-based-mcp-server",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "dockerizedServer": {\n      "command": "docker",\n      "args": [\n        "run",\n        "-i",\n        "--rm",\n        "-e",\n        "API_KEY",\n        "-v",\n        "${PWD}:/workspace",\n        "my-mcp-server:latest"\n      ],\n      "env": {\n        "API_KEY": "$EXTERNAL_SERVICE_TOKEN"\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"http-based-mcp-server",children:["HTTP-based MCP Server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#http-based-mcp-server",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "httpServer": {\n      "httpUrl": "http://localhost:3000/mcp",\n      "timeout": 5000\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"http-based-mcp-server-with-custom-headers",children:["HTTP-based MCP Server with Custom Headers",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#http-based-mcp-server-with-custom-headers",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "httpServerWithAuth": {\n      "httpUrl": "http://localhost:3000/mcp",\n      "headers": {\n        "Authorization": "Bearer your-api-token",\n        "X-Custom-Header": "custom-value",\n        "Content-Type": "application/json"\n      },\n      "timeout": 5000\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"mcp-server-with-tool-filtering",children:["MCP Server with Tool Filtering",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mcp-server-with-tool-filtering",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "filteredServer": {\n      "command": "python",\n      "args": ["-m", "my_mcp_server"],\n      "includeTools": ["safe_tool", "file_reader", "data_processor"],\n      // "excludeTools": ["dangerous_tool", "file_deleter"],\n      "timeout": 30000\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h2,{id:"discovery-process-deep-dive",children:["Discovery Process Deep Dive",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#discovery-process-deep-dive",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"When the VeCLI starts, it performs MCP server discovery through the following detailed process:"}),"\n",(0,r.jsxs)(n.h3,{id:"1-server-iteration-and-connection",children:["1. Server Iteration and Connection",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-server-iteration-and-connection",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["For each configured server in ",(0,r.jsx)(n.code,{children:"mcpServers"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status tracking begins:"})," Server status is set to ",(0,r.jsx)(n.code,{children:"CONNECTING"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Transport selection:"})," Based on configuration properties:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"httpUrl"})," → ",(0,r.jsx)(n.code,{children:"StreamableHTTPClientTransport"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"url"})," → ",(0,r.jsx)(n.code,{children:"SSEClientTransport"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"command"})," → ",(0,r.jsx)(n.code,{children:"StdioClientTransport"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection establishment:"})," The MCP client attempts to connect with the configured timeout"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error handling:"})," Connection failures are logged and the server status is set to ",(0,r.jsx)(n.code,{children:"DISCONNECTED"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"2-tool-discovery",children:["2. Tool Discovery",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-tool-discovery",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Upon successful connection:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tool listing:"})," The client calls the MCP server's tool listing endpoint"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Schema validation:"})," Each tool's function declaration is validated"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tool filtering:"})," Tools are filtered based on ",(0,r.jsx)(n.code,{children:"includeTools"})," and ",(0,r.jsx)(n.code,{children:"excludeTools"})," configuration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name sanitization:"})," Tool names are cleaned to meet Gemini API requirements:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Invalid characters (non-alphanumeric, underscore, dot, hyphen) are replaced with underscores"}),"\n",(0,r.jsxs)(n.li,{children:["Names longer than 63 characters are truncated with middle replacement (",(0,r.jsx)(n.code,{children:"___"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"3-conflict-resolution",children:["3. Conflict Resolution",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3-conflict-resolution",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"When multiple servers expose tools with the same name:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"First registration wins:"})," The first server to register a tool name gets the unprefixed name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic prefixing:"})," Subsequent servers get prefixed names: ",(0,r.jsx)(n.code,{children:"serverName__toolName"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Registry tracking:"})," The tool registry maintains mappings between server names and their tools"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"4-schema-processing",children:["4. Schema Processing",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-schema-processing",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Tool parameter schemas undergo sanitization for Gemini API compatibility:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"$schema"})," properties"]})," are removed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"additionalProperties"})})," are stripped"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"anyOf"})," with ",(0,r.jsx)(n.code,{children:"default"})]})," have their default values removed (Vertex AI compatibility)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Recursive processing"})," applies to nested schemas"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"5-connection-management",children:["5. Connection Management",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#5-connection-management",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"After discovery:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Persistent connections:"})," Servers that successfully register tools maintain their connections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cleanup:"})," Servers that provide no usable tools have their connections closed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status updates:"})," Final server statuses are set to ",(0,r.jsx)(n.code,{children:"CONNECTED"})," or ",(0,r.jsx)(n.code,{children:"DISCONNECTED"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"tool-execution-flow",children:["Tool Execution Flow",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#tool-execution-flow",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"When the Gemini model decides to use an MCP tool, the following execution flow occurs:"}),"\n",(0,r.jsxs)(n.h3,{id:"1-tool-invocation",children:["1. Tool Invocation",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-tool-invocation",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The model generates a ",(0,r.jsx)(n.code,{children:"FunctionCall"})," with:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tool name:"})," The registered name (potentially prefixed)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Arguments:"})," JSON object matching the tool's parameter schema"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"2-confirmation-process",children:["2. Confirmation Process",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-confirmation-process",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["Each ",(0,r.jsx)(n.code,{children:"DiscoveredMCPTool"})," implements sophisticated confirmation logic:"]}),"\n",(0,r.jsxs)(n.h4,{id:"trust-based-bypass",children:["Trust-based Bypass",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#trust-based-bypass",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"if (this.trust) {\n  return false; // No confirmation needed\n}\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"dynamic-allow-listing",children:["Dynamic Allow-listing",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#dynamic-allow-listing",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"The system maintains internal allow-lists for:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server-level:"})," ",(0,r.jsx)(n.code,{children:"serverName"})," → All tools from this server are trusted"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tool-level:"})," ",(0,r.jsx)(n.code,{children:"serverName.toolName"})," → This specific tool is trusted"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"user-choice-handling",children:["User Choice Handling",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#user-choice-handling",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"When confirmation is required, users can choose:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Proceed once:"})," Execute this time only"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Always allow this tool:"})," Add to tool-level allow-list"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Always allow this server:"})," Add to server-level allow-list"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cancel:"})," Abort execution"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"3-execution",children:["3. Execution",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#3-execution",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Upon confirmation (or trust bypass):"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Parameter preparation:"})," Arguments are validated against the tool's schema"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"MCP call:"})," The underlying ",(0,r.jsx)(n.code,{children:"CallableTool"})," invokes the server with:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const functionCalls = [\n  {\n    name: this.serverToolName, // Original server tool name\n    args: params,\n  },\n];\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Response processing:"})," Results are formatted for both LLM context and user display"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"4-response-handling",children:["4. Response Handling",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#4-response-handling",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"The execution result contains:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"llmContent"}),":"]})," Raw response parts for the language model's context"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"returnDisplay"}),":"]})," Formatted output for user display (often JSON in markdown code blocks)"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"how-to-interact-with-your-mcp-server",children:["How to interact with your MCP server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#how-to-interact-with-your-mcp-server",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"using-the-mcp-command",children:["Using the ",(0,r.jsx)(n.code,{children:"/mcp"})," Command",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#using-the-mcp-command",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"/mcp"})," command provides comprehensive information about your MCP server setup:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"/mcp\n"})}),"\n",(0,r.jsx)(n.p,{children:"This displays:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server list:"})," All configured MCP servers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection status:"})," ",(0,r.jsx)(n.code,{children:"CONNECTED"}),", ",(0,r.jsx)(n.code,{children:"CONNECTING"}),", or ",(0,r.jsx)(n.code,{children:"DISCONNECTED"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Server details:"})," Configuration summary (excluding sensitive data)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Available tools:"})," List of tools from each server with descriptions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Discovery state:"})," Overall discovery process status"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"example-mcp-output",children:["Example ",(0,r.jsx)(n.code,{children:"/mcp"})," Output",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#example-mcp-output",children:"#"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"MCP Servers Status:\n\n\uD83D\uDCE1 pythonTools (CONNECTED)\n  Command: python -m my_mcp_server --port 8080\n  Working Directory: ./mcp-servers/python\n  Timeout: 15000ms\n  Tools: calculate_sum, file_analyzer, data_processor\n\n\uD83D\uDD0C nodeServer (DISCONNECTED)\n  Command: node dist/server.js --verbose\n  Error: Connection refused\n\n\uD83D\uDC33 dockerizedServer (CONNECTED)\n  Command: docker run -i --rm -e API_KEY my-mcp-server:latest\n  Tools: docker__deploy, docker__status\n\nDiscovery State: COMPLETED\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"tool-usage",children:["Tool Usage",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#tool-usage",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Once discovered, MCP tools are available to the Gemini model like built-in tools. The model will automatically:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Select appropriate tools"})," based on your requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Present confirmation dialogs"})," (unless the server is trusted)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Execute tools"})," with proper parameters"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Display results"})," in a user-friendly format"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"status-monitoring-and-troubleshooting",children:["Status Monitoring and Troubleshooting",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#status-monitoring-and-troubleshooting",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"connection-states",children:["Connection States",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#connection-states",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"The MCP integration tracks several states:"}),"\n",(0,r.jsxs)(n.h4,{id:"server-status-mcpserverstatus",children:["Server Status (",(0,r.jsx)(n.code,{children:"MCPServerStatus"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#server-status-mcpserverstatus",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"DISCONNECTED"}),":"]})," Server is not connected or has errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"CONNECTING"}),":"]})," Connection attempt in progress"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"CONNECTED"}),":"]})," Server is connected and ready"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"discovery-state-mcpdiscoverystate",children:["Discovery State (",(0,r.jsx)(n.code,{children:"MCPDiscoveryState"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#discovery-state-mcpdiscoverystate",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"NOT_STARTED"}),":"]})," Discovery hasn't begun"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"IN_PROGRESS"}),":"]})," Currently discovering servers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"COMPLETED"}),":"]})," Discovery finished (with or without errors)"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"common-issues-and-solutions",children:["Common Issues and Solutions",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#common-issues-and-solutions",children:"#"})]}),"\n",(0,r.jsxs)(n.h4,{id:"server-wont-connect",children:["Server Won't Connect",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#server-wont-connect",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms:"})," Server shows ",(0,r.jsx)(n.code,{children:"DISCONNECTED"})," status"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Troubleshooting:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check configuration:"})," Verify ",(0,r.jsx)(n.code,{children:"command"}),", ",(0,r.jsx)(n.code,{children:"args"}),", and ",(0,r.jsx)(n.code,{children:"cwd"})," are correct"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test manually:"})," Run the server command directly to ensure it works"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check dependencies:"})," Ensure all required packages are installed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review logs:"})," Look for error messages in the CLI output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verify permissions:"})," Ensure the CLI can execute the server command"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"no-tools-discovered",children:["No Tools Discovered",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#no-tools-discovered",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms:"})," Server connects but no tools are available"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Troubleshooting:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Verify tool registration:"})," Ensure your server actually registers tools"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check MCP protocol:"})," Confirm your server implements the MCP tool listing correctly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Review server logs:"})," Check stderr output for server-side errors"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test tool listing:"})," Manually test your server's tool discovery endpoint"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"tools-not-executing",children:["Tools Not Executing",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#tools-not-executing",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms:"})," Tools are discovered but fail during execution"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Troubleshooting:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter validation:"})," Ensure your tool accepts the expected parameters"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Schema compatibility:"})," Verify your input schemas are valid JSON Schema"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error handling:"})," Check if your tool is throwing unhandled exceptions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timeout issues:"})," Consider increasing the ",(0,r.jsx)(n.code,{children:"timeout"})," setting"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"sandbox-compatibility",children:["Sandbox Compatibility",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#sandbox-compatibility",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms:"})," MCP servers fail when sandboxing is enabled"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Docker-based servers:"})," Use Docker containers that include all dependencies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Path accessibility:"})," Ensure server executables are available in the sandbox"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network access:"})," Configure sandbox to allow necessary network connections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Environment variables:"})," Verify required environment variables are passed through"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"debugging-tips",children:["Debugging Tips",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#debugging-tips",children:"#"})]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enable debug mode:"})," Run the CLI with ",(0,r.jsx)(n.code,{children:"--debug"})," for verbose output"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check stderr:"})," MCP server stderr is captured and logged (INFO messages filtered)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Test isolation:"})," Test your MCP server independently before integrating"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Incremental setup:"})," Start with simple tools before adding complex functionality"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Use ",(0,r.jsx)(n.code,{children:"/mcp"})," frequently:"]})," Monitor server status during development"]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"important-notes",children:["Important Notes",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#important-notes",children:"#"})]}),"\n",(0,r.jsxs)(n.h3,{id:"security-considerations",children:["Security Considerations",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#security-considerations",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Trust settings:"})," The ",(0,r.jsx)(n.code,{children:"trust"})," option bypasses all confirmation dialogs. Use cautiously and only for servers you completely control"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access tokens:"})," Be security-aware when configuring environment variables containing API keys or tokens"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sandbox compatibility:"})," When using sandboxing, ensure MCP servers are available within the sandbox environment"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Private data:"})," Using broadly scoped personal access tokens can lead to information leakage between repositories"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"performance-and-resource-management",children:["Performance and Resource Management",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#performance-and-resource-management",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Connection persistence:"})," The CLI maintains persistent connections to servers that successfully register tools"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automatic cleanup:"})," Connections to servers providing no tools are automatically closed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timeout management:"})," Configure appropriate timeouts based on your server's response characteristics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resource monitoring:"})," MCP servers run as separate processes and consume system resources"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"schema-compatibility",children:["Schema Compatibility",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#schema-compatibility",children:"#"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Property stripping:"})," The system automatically removes certain schema properties (",(0,r.jsx)(n.code,{children:"$schema"}),", ",(0,r.jsx)(n.code,{children:"additionalProperties"}),") for Gemini API compatibility"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name sanitization:"})," Tool names are automatically sanitized to meet API requirements"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Conflict resolution:"})," Tool name conflicts between servers are resolved through automatic prefixing"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This comprehensive integration makes MCP servers a powerful way to extend the VeCLI's capabilities while maintaining security, reliability, and ease of use."}),"\n",(0,r.jsxs)(n.h2,{id:"returning-rich-content-from-tools",children:["Returning Rich Content from Tools",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#returning-rich-content-from-tools",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"MCP tools are not limited to returning simple text. You can return rich, multi-part content, including text, images, audio, and other binary data in a single tool response. This allows you to build powerful tools that can provide diverse information to the model in a single turn."}),"\n",(0,r.jsx)(n.p,{children:"All data returned from the tool is processed and sent to the model as context for its next generation, enabling it to reason about or summarize the provided information."}),"\n",(0,r.jsxs)(n.h3,{id:"how-it-works",children:["How It Works",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#how-it-works",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["To return rich content, your tool's response must adhere to the MCP specification for a ",(0,r.jsx)(n.a,{href:"https://modelcontextprotocol.io/specification/2025-06-18/server/tools#tool-result",target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(n.code,{children:"CallToolResult"})}),". The ",(0,r.jsx)(n.code,{children:"content"})," field of the result should be an array of ",(0,r.jsx)(n.code,{children:"ContentBlock"})," objects. The VeCLI will correctly process this array, separating text from binary data and packaging it for the model."]}),"\n",(0,r.jsxs)(n.p,{children:["You can mix and match different content block types in the ",(0,r.jsx)(n.code,{children:"content"})," array. The supported block types include:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"text"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"image"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"audio"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"resource"})," (embedded content)"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"resource_link"})}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"example-returning-text-and-an-image",children:["Example: Returning Text and an Image",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#example-returning-text-and-an-image",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Here is an example of a valid JSON response from an MCP tool that returns both a text description and an image:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "content": [\n    {\n      "type": "text",\n      "text": "Here is the logo you requested."\n    },\n    {\n      "type": "image",\n      "data": "BASE64_ENCODED_IMAGE_DATA_HERE",\n      "mimeType": "image/png"\n    },\n    {\n      "type": "text",\n      "text": "The logo was created in 2025."\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"When the VeCLI receives this response, it will:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Extract all the text and combine it into a single ",(0,r.jsx)(n.code,{children:"functionResponse"})," part for the model."]}),"\n",(0,r.jsxs)(n.li,{children:["Present the image data as a separate ",(0,r.jsx)(n.code,{children:"inlineData"})," part."]}),"\n",(0,r.jsx)(n.li,{children:"Provide a clean, user-friendly summary in the CLI, indicating that both text and an image were received."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This enables you to build sophisticated tools that can provide rich, multi-modal context to the Gemini model."}),"\n",(0,r.jsxs)(n.h2,{id:"mcp-prompts-as-slash-commands",children:["MCP Prompts as Slash Commands",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#mcp-prompts-as-slash-commands",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"In addition to tools, MCP servers can expose predefined prompts that can be executed as slash commands within the VeCLI. This allows you to create shortcuts for common or complex queries that can be easily invoked by name."}),"\n",(0,r.jsxs)(n.h3,{id:"defining-prompts-on-the-server",children:["Defining Prompts on the Server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#defining-prompts-on-the-server",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Here's a small example of a stdio MCP server that defines prompts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { McpServer } from '@modelcontextprotocol/sdk/server/mcp.js';\nimport { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';\nimport { z } from 'zod';\n\nconst server = new McpServer({\n  name: 'prompt-server',\n  version: '1.0.0',\n});\n\nserver.registerPrompt(\n  'poem-writer',\n  {\n    title: 'Poem Writer',\n    description: 'Write a nice haiku',\n    argsSchema: { title: z.string(), mood: z.string().optional() },\n  },\n  ({ title, mood }) => ({\n    messages: [\n      {\n        role: 'user',\n        content: {\n          type: 'text',\n          text: `Write a haiku${mood ? ` with the mood ${mood}` : ''} called ${title}. Note that a haiku is 5 syllables followed by 7 syllables followed by 5 syllables `,\n        },\n      },\n    ],\n  }),\n);\n\nconst transport = new StdioServerTransport();\nawait server.connect(transport);\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This can be included in ",(0,r.jsx)(n.code,{children:"settings.json"})," under ",(0,r.jsx)(n.code,{children:"mcpServers"})," with:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "mcpServers": {\n    "nodeServer": {\n      "command": "node",\n      "args": ["filename.ts"]\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"invoking-prompts",children:["Invoking Prompts",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#invoking-prompts",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"Once a prompt is discovered, you can invoke it using its name as a slash command. The CLI will automatically handle parsing arguments."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'/poem-writer --title="VeCLI" --mood="reverent"\n'})}),"\n",(0,r.jsx)(n.p,{children:"or, using positional arguments:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'/poem-writer "VeCLI" reverent\n'})}),"\n",(0,r.jsxs)(n.p,{children:["When you run this command, the VeCLI executes the ",(0,r.jsx)(n.code,{children:"prompts/get"})," method on the MCP server with the provided arguments. The server is responsible for substituting the arguments into the prompt template and returning the final prompt text. The CLI then sends this prompt to the model for execution. This provides a convenient way to automate and share common workflows."]}),"\n",(0,r.jsxs)(n.h2,{id:"managing-mcp-servers-with-gemini-mcp",children:["Managing MCP Servers with ",(0,r.jsx)(n.code,{children:"gemini mcp"}),(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#managing-mcp-servers-with-gemini-mcp",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["While you can always configure MCP servers by manually editing your ",(0,r.jsx)(n.code,{children:"settings.json"})," file, the VeCLI provides a convenient set of commands to manage your server configurations programmatically. These commands streamline the process of adding, listing, and removing MCP servers without needing to directly edit JSON files."]}),"\n",(0,r.jsxs)(n.h3,{id:"adding-a-server-gemini-mcp-add",children:["Adding a Server (",(0,r.jsx)(n.code,{children:"gemini mcp add"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#adding-a-server-gemini-mcp-add",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"add"})," command configures a new MCP server in your ",(0,r.jsx)(n.code,{children:"settings.json"}),". Based on the scope (",(0,r.jsx)(n.code,{children:"-s, --scope"}),"), it will be added to either the user config ",(0,r.jsx)(n.code,{children:"~/.ve/settings.json"})," or the project config ",(0,r.jsx)(n.code,{children:".ve/settings.json"})," file."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gemini mcp add [options] <name> <commandOrUrl> [args...]\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<name>"}),": A unique name for the server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"<commandOrUrl>"}),": The command to execute (for ",(0,r.jsx)(n.code,{children:"stdio"}),") or the URL (for ",(0,r.jsx)(n.code,{children:"http"}),"/",(0,r.jsx)(n.code,{children:"sse"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[args...]"}),": Optional arguments for a ",(0,r.jsx)(n.code,{children:"stdio"})," command."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Options (Flags):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-s, --scope"}),': Configuration scope (user or project). [default: "project"]']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-t, --transport"}),': Transport type (stdio, sse, http). [default: "stdio"]']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-e, --env"}),": Set environment variables (e.g. -e KEY=value)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"-H, --header"}),': Set HTTP headers for SSE and HTTP transports (e.g. -H "X-Api-Key: abc123" -H "Authorization: Bearer abc123").']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--timeout"}),": Set connection timeout in milliseconds."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--trust"}),": Trust the server (bypass all tool call confirmation prompts)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--description"}),": Set the description for the server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--include-tools"}),": A comma-separated list of tools to include."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--exclude-tools"}),": A comma-separated list of tools to exclude."]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"adding-an-stdio-server",children:["Adding an stdio server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#adding-an-stdio-server",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"This is the default transport for running local servers."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Basic syntax\ngemini mcp add <name> <command> [args...]\n\n# Example: Adding a local server\ngemini mcp add my-stdio-server -e API_KEY=123 /path/to/server arg1 arg2 arg3\n\n# Example: Adding a local python server\ngemini mcp add python-server python server.py --port 8080\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"adding-an-http-server",children:["Adding an HTTP server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#adding-an-http-server",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"This transport is for servers that use the streamable HTTP transport."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Basic syntax\ngemini mcp add --transport http <name> <url>\n\n# Example: Adding an HTTP server\ngemini mcp add --transport http http-server https://api.example.com/mcp/\n\n# Example: Adding an HTTP server with an authentication header\ngemini mcp add --transport http secure-http https://api.example.com/mcp/ --header "Authorization: Bearer abc123"\n'})}),"\n",(0,r.jsxs)(n.h4,{id:"adding-an-sse-server",children:["Adding an SSE server",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#adding-an-sse-server",children:"#"})]}),"\n",(0,r.jsx)(n.p,{children:"This transport is for servers that use Server-Sent Events (SSE)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Basic syntax\ngemini mcp add --transport sse <name> <url>\n\n# Example: Adding an SSE server\ngemini mcp add --transport sse sse-server https://api.example.com/sse/\n\n# Example: Adding an SSE server with an authentication header\ngemini mcp add --transport sse secure-sse https://api.example.com/sse/ --header "Authorization: Bearer abc123"\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"listing-servers-gemini-mcp-list",children:["Listing Servers (",(0,r.jsx)(n.code,{children:"gemini mcp list"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#listing-servers-gemini-mcp-list",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["To view all MCP servers currently configured, use the ",(0,r.jsx)(n.code,{children:"list"})," command. It displays each server's name, configuration details, and connection status."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gemini mcp list\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"✓ stdio-server: command: python3 server.py (stdio) - Connected\n✓ http-server: https://api.example.com/mcp (http) - Connected\n✗ sse-server: https://api.example.com/sse (sse) - Disconnected\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"removing-a-server-gemini-mcp-remove",children:["Removing a Server (",(0,r.jsx)(n.code,{children:"gemini mcp remove"}),")",(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#removing-a-server-gemini-mcp-remove",children:"#"})]}),"\n",(0,r.jsxs)(n.p,{children:["To delete a server from your configuration, use the ",(0,r.jsx)(n.code,{children:"remove"})," command with the server's name."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Command:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gemini mcp remove <name>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"gemini mcp remove my-server\n"})}),"\n",(0,r.jsxs)(n.p,{children:['This will find and delete the "my-server" entry from the ',(0,r.jsx)(n.code,{children:"mcpServers"})," object in the appropriate ",(0,r.jsx)(n.code,{children:"settings.json"})," file based on the scope (",(0,r.jsx)(n.code,{children:"-s, --scope"}),")."]})]})}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}let c=o;o.__RSPRESS_PAGE_META={},o.__RSPRESS_PAGE_META["tools%2Fmcp-server.md"]={toc:[{text:"What is an MCP server?",id:"what-is-an-mcp-server",depth:2},{text:"Core Integration Architecture",id:"core-integration-architecture",depth:2},{text:"Discovery Layer (`mcp-client.ts`)",id:"discovery-layer-mcp-clientts",depth:3},{text:"Execution Layer (`mcp-tool.ts`)",id:"execution-layer-mcp-toolts",depth:3},{text:"Transport Mechanisms",id:"transport-mechanisms",depth:3},{text:"How to set up your MCP server",id:"how-to-set-up-your-mcp-server",depth:2},{text:"Configure the MCP server in settings.json",id:"configure-the-mcp-server-in-settingsjson",depth:3},{text:"Global MCP Settings (`mcp`)",id:"global-mcp-settings-mcp",depth:4},{text:"Server-Specific Configuration (`mcpServers`)",id:"server-specific-configuration-mcpservers",depth:4},{text:"Configuration Structure",id:"configuration-structure",depth:3},{text:"Configuration Properties",id:"configuration-properties",depth:3},{text:"Required (one of the following)",id:"required-one-of-the-following",depth:4},{text:"Optional",id:"optional",depth:4},{text:"OAuth Support for Remote MCP Servers",id:"oauth-support-for-remote-mcp-servers",depth:3},{text:"Automatic OAuth Discovery",id:"automatic-oauth-discovery",depth:4},{text:"Authentication Flow",id:"authentication-flow",depth:4},{text:"Browser Redirect Requirements",id:"browser-redirect-requirements",depth:4},{text:"Managing OAuth Authentication",id:"managing-oauth-authentication",depth:4},{text:"OAuth Configuration Properties",id:"oauth-configuration-properties",depth:4},{text:"Token Management",id:"token-management",depth:4},{text:"Authentication Provider Type",id:"authentication-provider-type",depth:4},{text:"Example Configurations",id:"example-configurations",depth:3},{text:"Python MCP Server (Stdio)",id:"python-mcp-server-stdio",depth:4},{text:"Node.js MCP Server (Stdio)",id:"nodejs-mcp-server-stdio",depth:4},{text:"Docker-based MCP Server",id:"docker-based-mcp-server",depth:4},{text:"HTTP-based MCP Server",id:"http-based-mcp-server",depth:4},{text:"HTTP-based MCP Server with Custom Headers",id:"http-based-mcp-server-with-custom-headers",depth:4},{text:"MCP Server with Tool Filtering",id:"mcp-server-with-tool-filtering",depth:4},{text:"Discovery Process Deep Dive",id:"discovery-process-deep-dive",depth:2},{text:"1. Server Iteration and Connection",id:"1-server-iteration-and-connection",depth:3},{text:"2. Tool Discovery",id:"2-tool-discovery",depth:3},{text:"3. Conflict Resolution",id:"3-conflict-resolution",depth:3},{text:"4. Schema Processing",id:"4-schema-processing",depth:3},{text:"5. Connection Management",id:"5-connection-management",depth:3},{text:"Tool Execution Flow",id:"tool-execution-flow",depth:2},{text:"1. Tool Invocation",id:"1-tool-invocation",depth:3},{text:"2. Confirmation Process",id:"2-confirmation-process",depth:3},{text:"Trust-based Bypass",id:"trust-based-bypass",depth:4},{text:"Dynamic Allow-listing",id:"dynamic-allow-listing",depth:4},{text:"User Choice Handling",id:"user-choice-handling",depth:4},{text:"3. Execution",id:"3-execution",depth:3},{text:"4. Response Handling",id:"4-response-handling",depth:3},{text:"How to interact with your MCP server",id:"how-to-interact-with-your-mcp-server",depth:2},{text:"Using the `/mcp` Command",id:"using-the-mcp-command",depth:3},{text:"Example `/mcp` Output",id:"example-mcp-output",depth:3},{text:"Tool Usage",id:"tool-usage",depth:3},{text:"Status Monitoring and Troubleshooting",id:"status-monitoring-and-troubleshooting",depth:2},{text:"Connection States",id:"connection-states",depth:3},{text:"Server Status (`MCPServerStatus`)",id:"server-status-mcpserverstatus",depth:4},{text:"Discovery State (`MCPDiscoveryState`)",id:"discovery-state-mcpdiscoverystate",depth:4},{text:"Common Issues and Solutions",id:"common-issues-and-solutions",depth:3},{text:"Server Won't Connect",id:"server-wont-connect",depth:4},{text:"No Tools Discovered",id:"no-tools-discovered",depth:4},{text:"Tools Not Executing",id:"tools-not-executing",depth:4},{text:"Sandbox Compatibility",id:"sandbox-compatibility",depth:4},{text:"Debugging Tips",id:"debugging-tips",depth:3},{text:"Important Notes",id:"important-notes",depth:2},{text:"Security Considerations",id:"security-considerations",depth:3},{text:"Performance and Resource Management",id:"performance-and-resource-management",depth:3},{text:"Schema Compatibility",id:"schema-compatibility",depth:3},{text:"Returning Rich Content from Tools",id:"returning-rich-content-from-tools",depth:2},{text:"How It Works",id:"how-it-works",depth:3},{text:"Example: Returning Text and an Image",id:"example-returning-text-and-an-image",depth:3},{text:"MCP Prompts as Slash Commands",id:"mcp-prompts-as-slash-commands",depth:2},{text:"Defining Prompts on the Server",id:"defining-prompts-on-the-server",depth:3},{text:"Invoking Prompts",id:"invoking-prompts",depth:3},{text:"Managing MCP Servers with `gemini mcp`",id:"managing-mcp-servers-with-gemini-mcp",depth:2},{text:"Adding a Server (`gemini mcp add`)",id:"adding-a-server-gemini-mcp-add",depth:3},{text:"Adding an stdio server",id:"adding-an-stdio-server",depth:4},{text:"Adding an HTTP server",id:"adding-an-http-server",depth:4},{text:"Adding an SSE server",id:"adding-an-sse-server",depth:4},{text:"Listing Servers (`gemini mcp list`)",id:"listing-servers-gemini-mcp-list",depth:3},{text:"Removing a Server (`gemini mcp remove`)",id:"removing-a-server-gemini-mcp-remove",depth:3}],title:"MCP servers with the VeCLI",headingTitle:"MCP servers with the VeCLI",frontmatter:{}}}}]);