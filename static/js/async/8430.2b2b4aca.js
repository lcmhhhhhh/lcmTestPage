"use strict";(self.webpackChunklcm_test_page=self.webpackChunklcm_test_page||[]).push([["8430"],{7992:function(e,n,s){s.r(n),s.d(n,{default:()=>c});var d=s(5893),r=s(65);function i(e){let n=Object.assign({h1:"h1",a:"a",p:"p",h2:"h2",pre:"pre",code:"code",ul:"ul",li:"li",strong:"strong",h3:"h3",ol:"ol"},(0,r.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.h1,{id:"vecli-中的沙盒",children:["VeCLI 中的沙盒",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#vecli-中的沙盒",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"本文档提供了 VeCLI 中沙盒的指南，包括先决条件、快速入门和配置。"}),"\n",(0,d.jsxs)(n.h2,{id:"先决条件",children:["先决条件",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#先决条件",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"在使用沙盒之前，您需要安装并设置 VeCLI："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"npm install -g @vecode-cli/vecode-cli\n"})}),"\n",(0,d.jsx)(n.p,{children:"验证安装"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"gemini --version\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"沙盒概述",children:["沙盒概述",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#沙盒概述",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"沙盒将潜在的危险操作（例如 shell 命令或文件修改）与您的主机系统隔离开来，在 AI 操作和您的环境之间提供安全屏障。"}),"\n",(0,d.jsx)(n.p,{children:"沙盒的好处包括："}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"安全性"}),"：防止意外的系统损坏或数据丢失。"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"隔离性"}),"：将文件系统访问限制在项目目录内。"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"一致性"}),"：确保在不同系统上的环境可重现。"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"安全性"}),"：在处理不受信任的代码或实验性命令时降低风险。"]}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"沙盒方法",children:["沙盒方法",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#沙盒方法",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"您理想的沙盒方法可能因平台和您首选的容器解决方案而异。"}),"\n",(0,d.jsxs)(n.h3,{id:"1-macos-seatbelt仅限-macos",children:["1. macOS Seatbelt（仅限 macOS）",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-macos-seatbelt仅限-macos",children:"#"})]}),"\n",(0,d.jsxs)(n.p,{children:["使用 ",(0,d.jsx)(n.code,{children:"sandbox-exec"})," 的轻量级内置沙盒。"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"默认配置文件"}),"：",(0,d.jsx)(n.code,{children:"permissive-open"})," - 限制项目目录外的写入，但允许大多数其他操作。"]}),"\n",(0,d.jsxs)(n.h3,{id:"2-基于容器dockerpodman",children:["2. 基于容器（Docker/Podman）",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-基于容器dockerpodman",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"具有完整进程隔离的跨平台沙盒。"}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"注意"}),"：需要在本地构建沙盒镜像或使用组织注册表中发布的镜像。"]}),"\n",(0,d.jsxs)(n.h2,{id:"快速入门",children:["快速入门",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#快速入门",children:"#"})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'# 使用命令标志启用沙盒\ngemini -s -p "analyze the code structure"\n\n# 使用环境变量\nexport GEMINI_SANDBOX=true\ngemini -p "run the test suite"\n\n# 在 settings.json 中配置\n{\n  "tools": {\n    "sandbox": "docker"\n  }\n}\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"配置",children:["配置",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#配置",children:"#"})]}),"\n",(0,d.jsxs)(n.h3,{id:"启用沙盒按优先级顺序",children:["启用沙盒（按优先级顺序）",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#启用沙盒按优先级顺序",children:"#"})]}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"命令标志"}),"：",(0,d.jsx)(n.code,{children:"-s"})," 或 ",(0,d.jsx)(n.code,{children:"--sandbox"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"环境变量"}),"：",(0,d.jsx)(n.code,{children:"GEMINI_SANDBOX=true|docker|podman|sandbox-exec"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"设置文件"}),"：在 ",(0,d.jsx)(n.code,{children:"settings.json"})," 文件的 ",(0,d.jsx)(n.code,{children:"tools"})," 对象中设置 ",(0,d.jsx)(n.code,{children:'"sandbox": true'}),"（例如，",(0,d.jsx)(n.code,{children:'{"tools": {"sandbox": true}}'}),"）。"]}),"\n"]}),"\n",(0,d.jsxs)(n.h3,{id:"macos-seatbelt-配置文件",children:["macOS Seatbelt 配置文件",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#macos-seatbelt-配置文件",children:"#"})]}),"\n",(0,d.jsxs)(n.p,{children:["内置配置文件（通过 ",(0,d.jsx)(n.code,{children:"SEATBELT_PROFILE"})," 环境变量设置）："]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"permissive-open"}),"（默认）：写入限制，允许网络"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"permissive-closed"}),"：写入限制，无网络"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"permissive-proxied"}),"：写入限制，通过代理网络"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"restrictive-open"}),"：严格限制，允许网络"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"restrictive-closed"}),"：最大限制"]}),"\n"]}),"\n",(0,d.jsxs)(n.h3,{id:"自定义沙盒标志",children:["自定义沙盒标志",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#自定义沙盒标志",children:"#"})]}),"\n",(0,d.jsxs)(n.p,{children:["对于基于容器的沙盒，您可以使用 ",(0,d.jsx)(n.code,{children:"SANDBOX_FLAGS"})," 环境变量将自定义标志注入到 ",(0,d.jsx)(n.code,{children:"docker"})," 或 ",(0,d.jsx)(n.code,{children:"podman"})," 命令中。这对于高级配置很有用，例如为特定用例禁用安全功能。"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"示例（Podman）"}),"："]}),"\n",(0,d.jsx)(n.p,{children:"要为卷挂载禁用 SELinux 标记，您可以设置以下内容："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'export SANDBOX_FLAGS="--security-opt label=disable"\n'})}),"\n",(0,d.jsx)(n.p,{children:"可以提供多个标志作为空格分隔的字符串："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'export SANDBOX_FLAGS="--flag1 --flag2=value"\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"linux-uidgid-处理",children:["Linux UID/GID 处理",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#linux-uidgid-处理",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"沙盒会自动处理 Linux 上的用户权限。使用以下命令覆盖这些权限："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"export SANDBOX_SET_UID_GID=true   # 强制使用主机 UID/GID\nexport SANDBOX_SET_UID_GID=false  # 禁用 UID/GID 映射\n"})}),"\n",(0,d.jsxs)(n.h2,{id:"故障排除",children:["故障排除",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#故障排除",children:"#"})]}),"\n",(0,d.jsxs)(n.h3,{id:"常见问题",children:["常见问题",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#常见问题",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"“Operation not permitted”"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"操作需要沙盒外的访问权限。"}),"\n",(0,d.jsx)(n.li,{children:"尝试使用更宽松的配置文件或添加挂载点。"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"缺少命令"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"添加到自定义 Dockerfile 中。"}),"\n",(0,d.jsxs)(n.li,{children:["通过 ",(0,d.jsx)(n.code,{children:"sandbox.bashrc"})," 安装。"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.strong,{children:"网络问题"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"检查沙盒配置文件是否允许网络。"}),"\n",(0,d.jsx)(n.li,{children:"验证代理配置。"}),"\n"]}),"\n",(0,d.jsxs)(n.h3,{id:"调试模式",children:["调试模式",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#调试模式",children:"#"})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'DEBUG=1 gemini -s -p "debug command"\n'})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"注意："})," 如果您的项目 ",(0,d.jsx)(n.code,{children:".env"})," 文件中有 ",(0,d.jsx)(n.code,{children:"DEBUG=true"}),"，由于自动排除，它不会影响 gemini-cli。请使用 ",(0,d.jsx)(n.code,{children:".ve/.env"})," 文件进行 gemini-cli 特定的调试设置。"]}),"\n",(0,d.jsxs)(n.h3,{id:"检查沙盒",children:["检查沙盒",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#检查沙盒",children:"#"})]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'# 检查环境\ngemini -s -p "run shell command: env | grep SANDBOX"\n\n# 列出挂载\ngemini -s -p "run shell command: mount | grep workspace"\n'})}),"\n",(0,d.jsxs)(n.h2,{id:"安全说明",children:["安全说明",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安全说明",children:"#"})]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"沙盒可以减少但不能消除所有风险。"}),"\n",(0,d.jsx)(n.li,{children:"使用允许您工作的最严格的配置文件。"}),"\n",(0,d.jsx)(n.li,{children:"首次构建后，容器开销很小。"}),"\n",(0,d.jsx)(n.li,{children:"GUI 应用程序可能在沙盒中无法工作。"}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"相关文档",children:["相关文档",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#相关文档",children:"#"})]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/zh/cli/configuration",children:"配置"}),"：完整配置选项。"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/zh/cli/commands",children:"命令"}),"：可用命令。"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"/zh/troubleshooting",children:"故障排除"}),"：一般故障排除。"]}),"\n"]})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(i,{...e})}):i(e)}let c=h;h.__RSPRESS_PAGE_META={},h.__RSPRESS_PAGE_META["zh%2Fsandbox.md"]={toc:[{text:"先决条件",id:"先决条件",depth:2},{text:"沙盒概述",id:"沙盒概述",depth:2},{text:"沙盒方法",id:"沙盒方法",depth:2},{text:"1. macOS Seatbelt（仅限 macOS）",id:"1-macos-seatbelt仅限-macos",depth:3},{text:"2. 基于容器（Docker/Podman）",id:"2-基于容器dockerpodman",depth:3},{text:"快速入门",id:"快速入门",depth:2},{text:"配置",id:"配置",depth:2},{text:"启用沙盒（按优先级顺序）",id:"启用沙盒按优先级顺序",depth:3},{text:"macOS Seatbelt 配置文件",id:"macos-seatbelt-配置文件",depth:3},{text:"自定义沙盒标志",id:"自定义沙盒标志",depth:3},{text:"Linux UID/GID 处理",id:"linux-uidgid-处理",depth:2},{text:"故障排除",id:"故障排除",depth:2},{text:"常见问题",id:"常见问题",depth:3},{text:"调试模式",id:"调试模式",depth:3},{text:"检查沙盒",id:"检查沙盒",depth:3},{text:"安全说明",id:"安全说明",depth:2},{text:"相关文档",id:"相关文档",depth:2}],title:"VeCLI 中的沙盒",headingTitle:"VeCLI 中的沙盒",frontmatter:{}}}}]);