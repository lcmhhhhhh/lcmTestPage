"use strict";(self.webpackChunklcm_test_page=self.webpackChunklcm_test_page||[]).push([["7012"],{1598:function(e,n,l){l.r(n),l.d(n,{default:()=>r});var s=l(5893),i=l(65);function c(e){let n=Object.assign({h1:"h1",a:"a",p:"p",strong:"strong",h2:"h2",code:"code",h3:"h3",ol:"ol",li:"li",ul:"ul",em:"em",pre:"pre"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"vecli-可观测性指南",children:["VeCLI 可观测性指南",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#vecli-可观测性指南",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"遥测技术提供有关 VeCLI 性能、健康状况和使用情况的数据。通过启用它，您可以通过跟踪、指标和结构化日志来监控操作、调试问题和优化工具使用。"}),"\n",(0,s.jsxs)(n.p,{children:["VeCLI 的遥测系统基于 ",(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.a,{href:"https://opentelemetry.io/",target:"_blank",rel:"noopener noreferrer",children:"OpenTelemetry"})," (OTEL)"]})," 标准构建，允许您将数据发送到任何兼容的后端。"]}),"\n",(0,s.jsxs)(n.h2,{id:"启用遥测",children:["启用遥测",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#启用遥测",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["您可以通过多种方式启用遥测。配置主要通过 ",(0,s.jsxs)(n.a,{href:"/zh/cli/configuration",children:[(0,s.jsx)(n.code,{children:".ve/settings.json"})," 文件"]})," 和环境变量进行管理，但 CLI 标志可以覆盖这些设置以用于特定会话。"]}),"\n",(0,s.jsxs)(n.h3,{id:"优先级顺序",children:["优先级顺序",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#优先级顺序",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"以下列出了应用遥测设置的优先级，列表中较高的项目具有更高的优先级："}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["CLI 标志 (用于 ",(0,s.jsx)(n.code,{children:"vecli"})," 命令):"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--telemetry"})," / ",(0,s.jsx)(n.code,{children:"--no-telemetry"}),": 覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.enabled"}),"。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--telemetry-target <local|ve>"}),": 覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.target"}),"。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--telemetry-otlp-endpoint <URL>"}),": 覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.otlpEndpoint"}),"。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--telemetry-log-prompts"})," / ",(0,s.jsx)(n.code,{children:"--no-telemetry-log-prompts"}),": 覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.logPrompts"}),"。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--telemetry-outfile <path>"}),": 将遥测输出重定向到文件。请参阅 ",(0,s.jsx)(n.a,{href:"#exporting-to-a-file",children:"导出到文件"}),"。"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"环境变量:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"OTEL_EXPORTER_OTLP_ENDPOINT"}),": 覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.otlpEndpoint"}),"。"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["工作区设置文件 (",(0,s.jsx)(n.code,{children:".ve/settings.json"}),"):"]})," 来自此项目特定文件中 ",(0,s.jsx)(n.code,{children:"telemetry"})," 对象的值。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["用户设置文件 (",(0,s.jsx)(n.code,{children:"~/.ve/settings.json"}),"):"]})," 来自此全局用户文件中 ",(0,s.jsx)(n.code,{children:"telemetry"})," 对象的值。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"默认值:"})," 如果未通过上述任何方式设置，则应用默认值。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"telemetry.enabled"}),": ",(0,s.jsx)(n.code,{children:"false"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"telemetry.target"}),": ",(0,s.jsx)(n.code,{children:"local"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"telemetry.otlpEndpoint"}),": ",(0,s.jsx)(n.code,{children:"http://localhost:4317"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"telemetry.logPrompts"}),": ",(0,s.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["对于 ",(0,s.jsx)(n.code,{children:"npm run telemetry -- --target=<ve|local>"})," 脚本:"]}),"\n此脚本的 ",(0,s.jsx)(n.code,{children:"--target"})," 参数 ",(0,s.jsx)(n.em,{children:"仅"})," 在该脚本的持续时间和目的内覆盖 ",(0,s.jsx)(n.code,{children:"telemetry.target"}),"（即，选择要启动的收集器）。它不会永久更改您的 ",(0,s.jsx)(n.code,{children:"settings.json"}),"。该脚本将首先查看 ",(0,s.jsx)(n.code,{children:"settings.json"})," 以获取 ",(0,s.jsx)(n.code,{children:"telemetry.target"})," 作为其默认值。"]}),"\n",(0,s.jsxs)(n.h3,{id:"示例设置",children:["示例设置",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#示例设置",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["以下代码可以添加到您的工作区 (",(0,s.jsx)(n.code,{children:".ve/settings.json"}),") 或用户 (",(0,s.jsx)(n.code,{children:"~/.ve/settings.json"}),") 设置中，以启用遥测并将输出发送到火山引擎："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "telemetry": {\n    "enabled": true,\n    "target": "ve"\n  },\n  "tools": {\n    "sandbox": false\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"导出到文件",children:["导出到文件",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#导出到文件",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"您可以将所有遥测数据导出到文件以供本地检查。"}),"\n",(0,s.jsxs)(n.p,{children:["要启用文件导出，请使用 ",(0,s.jsx)(n.code,{children:"--telemetry-outfile"})," 标志并指定所需输出文件的路径。这必须使用 ",(0,s.jsx)(n.code,{children:"--telemetry-target=local"})," 运行。"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# 设置您想要的输出文件路径\nTELEMETRY_FILE=".ve/telemetry.log"\n\n# 使用本地遥测运行 VeCLI\n# 注意: --telemetry-otlp-endpoint="" 是必需的，以覆盖默认的\n# OTLP 导出器并确保遥测数据写入本地文件。\nvecli --telemetry \\\n  --telemetry-target=local \\\n  --telemetry-otlp-endpoint="" \\\n  --telemetry-outfile="$TELEMETRY_FILE" \\\n  --prompt "What is OpenTelemetry?"\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"运行-otel-收集器",children:["运行 OTEL 收集器",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#运行-otel-收集器",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["OTEL 收集器是一个接收、处理和导出遥测数据的服务。\nCLI 可以使用 OTLP/gRPC 或 OTLP/HTTP 协议发送数据。\n您可以通过 ",(0,s.jsx)(n.code,{children:"--telemetry-otlp-protocol"})," 标志或 ",(0,s.jsx)(n.code,{children:"settings.json"})," 文件中的 ",(0,s.jsx)(n.code,{children:"telemetry.otlpProtocol"})," 设置指定要使用的协议。有关更多详细信息，请参阅 ",(0,s.jsx)(n.a,{href:"/zh/cli/configuration#--telemetry-otlp-protocol",children:"配置文档"}),"。"]}),"\n",(0,s.jsxs)(n.p,{children:["在 ",(0,s.jsx)(n.a,{href:"https://opentelemetry.io/docs/languages/sdk-configuration/otlp-exporter/",target:"_blank",rel:"noopener noreferrer",children:"documentation"})," 中了解更多关于 OTEL 导出器标准配置的信息。"]}),"\n",(0,s.jsxs)(n.h3,{id:"本地",children:["本地",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#本地",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["使用 ",(0,s.jsx)(n.code,{children:"npm run telemetry -- --target=local"})," 命令来自动化设置本地遥测管道的过程，包括在 ",(0,s.jsx)(n.code,{children:".ve/settings.json"})," 文件中配置必要的设置。底层脚本安装 ",(0,s.jsx)(n.code,{children:"otelcol-contrib"}),"（OpenTelemetry 收集器）和 ",(0,s.jsx)(n.code,{children:"jaeger"}),"（用于查看跟踪的 Jaeger UI）。要使用它："]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"运行命令"}),":\n从存储库的根目录执行命令："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run telemetry -- --target=local\n"})}),"\n",(0,s.jsx)(n.p,{children:"该脚本将："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"如果需要，下载 Jaeger 和 OTEL。"}),"\n",(0,s.jsx)(n.li,{children:"启动一个本地 Jaeger 实例。"}),"\n",(0,s.jsx)(n.li,{children:"启动一个配置为从 VeCLI 接收数据的 OTEL 收集器。"}),"\n",(0,s.jsx)(n.li,{children:"自动在您的工作区设置中启用遥测。"}),"\n",(0,s.jsx)(n.li,{children:"退出时，禁用遥测。"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"查看跟踪"}),":\n打开您的网络浏览器并导航到 ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"http://localhost:16686",target:"_blank",rel:"noopener noreferrer",children:"http://localhost:16686"})})," 以访问 Jaeger UI。在这里您可以检查 VeCLI 操作的详细跟踪。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"检查日志和指标"}),":\n该脚本将 OTEL 收集器输出（包括日志和指标）重定向到 ",(0,s.jsx)(n.code,{children:"~/.ve/tmp/<projectHash>/otel/collector.log"}),"。该脚本将提供链接以查看并在本地跟踪您的遥测数据（跟踪、指标、日志）。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"停止服务"}),":\n在运行脚本的终端中按 ",(0,s.jsx)(n.code,{children:"Ctrl+C"})," 以停止 OTEL 收集器和 Jaeger 服务。"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"火山引擎",children:["火山引擎",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#火山引擎",children:"#"})]}),"\n",(0,s.jsxs)(n.p,{children:["使用 ",(0,s.jsx)(n.code,{children:"npm run telemetry -- --target=volc"})," 命令来自动化设置一个本地 OpenTelemetry 收集器，该收集器将数据转发到您的火山引擎项目，包括在 ",(0,s.jsx)(n.code,{children:".ve/settings.json"})," 文件中配置必要的设置。底层脚本安装 ",(0,s.jsx)(n.code,{children:"otelcol-contrib"}),"。要使用它："]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"运行命令"}),":\n从存储库的根目录执行命令："]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm run telemetry -- --target=ve\n"})}),"\n",(0,s.jsx)(n.p,{children:"该脚本将："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["如果需要，下载 ",(0,s.jsx)(n.code,{children:"otelcol-contrib"})," 二进制文件。"]}),"\n",(0,s.jsx)(n.li,{children:"启动一个配置为从 VeCLI 接收数据并将其导出到您指定的火山引擎项目的 OTEL 收集器。"}),"\n",(0,s.jsxs)(n.li,{children:["自动在您的工作区设置 (",(0,s.jsx)(n.code,{children:".ve/settings.json"}),") 中启用遥测并禁用沙盒模式。"]}),"\n",(0,s.jsx)(n.li,{children:"提供直接链接以在您的火山引擎控制台中查看跟踪、指标和日志。"}),"\n",(0,s.jsx)(n.li,{children:"退出时 (Ctrl+C)，它将尝试恢复您原来的遥测和沙盒设置。"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"运行 VeCLI"}),":\n在一个单独的终端中，运行您的 VeCLI 命令。这会生成遥测数据，收集器会捕获这些数据。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"在火山引擎中查看遥测数据"}),":\n使用脚本提供的链接导航到火山引擎控制台并查看您的跟踪、指标和日志。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"检查本地收集器日志"}),":\n该脚本将本地 OTEL 收集器输出重定向到 ",(0,s.jsx)(n.code,{children:"~/.ve/tmp/<projectHash>/otel/collector-ve.log"}),"。该脚本提供链接以查看并在本地跟踪您的收集器日志。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"停止服务"}),":\n在运行脚本的终端中按 ",(0,s.jsx)(n.code,{children:"Ctrl+C"})," 以停止 OTEL 收集器。"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"日志和指标参考",children:["日志和指标参考",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#日志和指标参考",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"以下部分描述了为 VeCLI 生成的日志和指标的结构。"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["所有日志和指标上都包含一个 ",(0,s.jsx)(n.code,{children:"sessionId"})," 作为公共属性。"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"日志",children:["日志",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#日志",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"日志是特定事件的时间戳记录。为 VeCLI 记录以下事件："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.config"}),": 此事件在启动时发生一次，并带有 CLI 的配置。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"model"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"embedding_model"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sandbox_enabled"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"core_tools_enabled"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"approval_mode"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api_key_enabled"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"vertex_ai_enabled"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"code_assist_enabled"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"log_prompts_enabled"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"file_filtering_respect_git_ignore"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"debug_mode"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mcp_servers"})," (字符串)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.user_prompt"}),": 当用户提交提示时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"prompt_length"})," (整数)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"prompt_id"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"prompt"})," (字符串, 如果 ",(0,s.jsx)(n.code,{children:"log_prompts_enabled"})," 配置为 ",(0,s.jsx)(n.code,{children:"false"}),"，则此属性被排除)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"auth_type"})," (字符串)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.tool_call"}),": 每次函数调用时都会发生此事件。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"function_name"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"function_args"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"duration_ms"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"success"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"decision"}),' (字符串: "accept", "reject", "auto_accept", 或 "modify", 如果适用)']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error"})," (如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error_type"})," (如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"metadata"})," (如果适用, 字符串 -> 任何的字典)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.file_operation"}),": 每次文件操作时都会发生此事件。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tool_name"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"operation"}),' (字符串: "create", "read", "update")']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"lines"})," (整数, 如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mimetype"})," (字符串, 如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"extension"})," (字符串, 如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"programming_language"})," (字符串, 如果适用)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"diff_stat"})," (json 字符串, 如果适用): 一个包含以下成员的 JSON 字符串:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ai_added_lines"})," (整数)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ai_removed_lines"})," (整数)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"user_added_lines"})," (整数)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"user_removed_lines"})," (整数)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.api_request"}),": 向火山引擎 API 发出请求时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"request_text"})," (如果适用)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.api_error"}),": 如果 API 请求失败，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"error"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"error_type"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"status_code"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"duration_ms"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"auth_type"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.api_response"}),": 接收到 vecli API 的响应时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"status_code"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"duration_ms"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error"})," (可选)"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"input_token_count"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"output_token_count"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"cached_content_token_count"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"thoughts_token_count"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"tool_token_count"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"response_text"})," (如果适用)"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"auth_type"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.malformed_json_response"}),": 当 vecli API 的 ",(0,s.jsx)(n.code,{children:"generateJson"})," 响应无法解析为 json 时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.flash_fallback"}),": 当 VeCLI 切换到 flash 作为后备时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"auth_type"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.slash_command"}),": 当用户执行斜杠命令时，此事件发生。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"command"})," (字符串)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"subcommand"})," (字符串, 如果适用)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"指标",children:["指标",(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#指标",children:"#"})]}),"\n",(0,s.jsx)(n.p,{children:"指标是随时间推移的行为的数值测量。为 VeCLI 收集以下指标："}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.session.count"})," (计数器, 整数): 每次 CLI 启动时递增一次。"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.tool.call.count"})," (计数器, 整数): 计算工具调用次数。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"function_name"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"success"})," (布尔值)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"decision"}),' (字符串: "accept", "reject", 或 "modify", 如果适用)']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tool_type"}),' (字符串: "mcp", 或 "native", 如果适用)']}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.tool.call.latency"})," (直方图, 毫秒): 测量工具调用延迟。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"function_name"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"decision"}),' (字符串: "accept", "reject", 或 "modify", 如果适用)']}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.api.request.count"})," (计数器, 整数): 计算所有 API 请求次数。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"status_code"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"error_type"})," (如果适用)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"vecli.api.request.latency"})," (直方图, 毫秒): 测量 API 请求延迟。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"gemini_cli.token.usage"})," (计数器, 整数): 计算使用的令牌数量。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"model"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type"}),' (字符串: "input", "output", "thought", "cache", 或 "tool")']}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"gemini_cli.file.operation.count"})," (计数器, 整数): 计算文件操作次数。"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"operation"}),' (字符串: "create", "read", "update"): 文件操作的类型。']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"lines"})," (整数, 如果适用): 文件中的行数。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mimetype"})," (字符串, 如果适用): 文件的 mimetype。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"extension"})," (字符串, 如果适用): 文件的扩展名。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"model_added_lines"})," (整数, 如果适用): 模型添加/更改的行数。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"model_removed_lines"})," (整数, 如果适用): 模型删除/更改的行数。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"user_added_lines"})," (整数, 如果适用): 用户在 AI 提出的更改中添加/更改的行数。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"user_removed_lines"})," (整数, 如果适用): 用户在 AI 提出的更改中删除/更改的行数。"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"programming_language"})," (字符串, 如果适用): 文件的编程语言。"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"gemini_cli.chat_compression"})," (计数器, 整数): 计算聊天压缩操作次数"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"属性"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tokens_before"}),": (整数): 压缩前上下文中的令牌数"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tokens_after"}),": (整数): 压缩后上下文中的令牌数"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}let r=d;d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["zh%2Ftelemetry.md"]={toc:[{text:"启用遥测",id:"启用遥测",depth:2},{text:"优先级顺序",id:"优先级顺序",depth:3},{text:"示例设置",id:"示例设置",depth:3},{text:"导出到文件",id:"导出到文件",depth:3},{text:"运行 OTEL 收集器",id:"运行-otel-收集器",depth:2},{text:"本地",id:"本地",depth:3},{text:"火山引擎",id:"火山引擎",depth:3},{text:"日志和指标参考",id:"日志和指标参考",depth:2},{text:"日志",id:"日志",depth:3},{text:"指标",id:"指标",depth:3}],title:"VeCLI 可观测性指南",headingTitle:"VeCLI 可观测性指南",frontmatter:{}}}}]);